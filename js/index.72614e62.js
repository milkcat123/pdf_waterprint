(function(){"use strict";var t={1735:function(t,i,e){var n=e(5130),a=e(6768),o=e(4232);const l=t=>((0,a.Qi)("data-v-b5393b8c"),t=t(),(0,a.jt)(),t),s={id:"app"},r={class:"left_side"},d=l((()=>(0,a.Lk)("h1",null,"PDF浮水印工具",-1))),c={class:"card bg_1"},p=(0,a.Fv)('<div class="wrap_step" data-v-b5393b8c><div class="step" data-v-b5393b8c>1</div><div class="icon" data-v-b5393b8c><i class="bi bi-file-arrow-up" data-v-b5393b8c></i></div></div><div class="card_title" data-v-b5393b8c><h2 data-v-b5393b8c>上傳PDF檔案</h2><div class="sub" data-v-b5393b8c>upload file</div></div>',2),u={class:"content"},b={class:"card bg_2"},g=(0,a.Fv)('<div class="wrap_step" data-v-b5393b8c><div class="step" data-v-b5393b8c>2</div><div class="icon" data-v-b5393b8c><i class="bi bi-clipboard2-data" data-v-b5393b8c></i></div></div><div class="card_title" data-v-b5393b8c><h2 data-v-b5393b8c>文件資訊</h2><div class="sub" data-v-b5393b8c>document info</div></div>',2),h={class:"content"},f={class:"row"},v=l((()=>(0,a.Lk)("span",null,"名稱：",-1))),k={class:"display"},L={class:"row"},w=l((()=>(0,a.Lk)("span",null,"總頁數：",-1))),m={class:"display"},y=l((()=>(0,a.Lk)("span",null,"寬(x)：",-1))),x={class:"display"},P=l((()=>(0,a.Lk)("span",null,"高(y)：",-1))),_={class:"display"},O={class:"card bg_3"},C=(0,a.Fv)('<div class="wrap_step" data-v-b5393b8c><div class="step" data-v-b5393b8c>3</div><div class="icon" data-v-b5393b8c><i class="bi bi-passport" data-v-b5393b8c></i></div></div><div class="card_title" data-v-b5393b8c><h2 data-v-b5393b8c>設定浮水印</h2><div class="sub" data-v-b5393b8c>waterprint setting</div></div>',2),F={class:"content"},T={class:"row option"},j={class:"option_item"},E=["id","value","checked","onClick"],D=["for"],M=["onUpdate:modelValue"],S={key:1,class:"row"},U=l((()=>(0,a.Lk)("span",null,"浮水印文字：",-1))),V={key:2,class:"row option"},R=l((()=>(0,a.Lk)("span",null,"密度：",-1))),X={class:"option_item"},A=["value","id","checked","onClick"],H=["for"],z={class:"row"},I=l((()=>(0,a.Lk)("span",null,"字體大小：",-1))),J=l((()=>(0,a.Lk)("span",null,"顏色：",-1))),B=l((()=>(0,a.Lk)("span",null,"旋轉角度：",-1))),G=["disabled"],K={class:"row"},Q={class:"row"},$=l((()=>(0,a.Lk)("span",{class:"bold"},"起始位置 |",-1))),N=l((()=>(0,a.Lk)("span",null,"水平(x軸)：",-1))),W=["max","disabled"],Y=l((()=>(0,a.Lk)("span",null,"垂直(y軸)：",-1))),q=["max","disabled"],Z=["disabled"],tt={class:"right_side"},it={class:"pdfwrap"},et={frameborder:"1",ref:"pdfView"};function nt(t,i,e,l,nt,at){const ot=(0,a.g2)("AuthorInfo"),lt=(0,a.g2)("Loading");return(0,a.uX)(),(0,a.CE)("div",s,[(0,a.bF)(ot),(0,a.bF)(lt,{"is-full-page":!0,active:nt.reloading,"z-index":10},{default:(0,a.k6)((()=>[(0,a.eW)("...製作中，請稍後...")])),_:1},8,["active"]),(0,a.Lk)("div",r,[d,(0,a.Lk)("div",c,[p,(0,a.Lk)("div",u,[(0,a.Lk)("input",{type:"file",name:"uploadPdf",id:"uploadPdf",accept:".pdf",onChange:i[0]||(i[0]=t=>at.getFile(t))},null,32)])]),(0,a.Lk)("div",b,[g,(0,a.Lk)("div",h,[(0,a.Lk)("div",f,[v,(0,a.Lk)("span",k,(0,o.v_)(nt.original.name),1)]),(0,a.Lk)("div",L,[w,(0,a.Lk)("span",m,(0,o.v_)(nt.original.totalPages),1),y,(0,a.Lk)("span",x,(0,o.v_)(nt.original.width),1),P,(0,a.Lk)("span",_,(0,o.v_)(nt.original.height),1)])])]),(0,a.bo)((0,a.Lk)("div",O,[C,(0,a.Lk)("div",F,[(0,a.Lk)("div",T,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Object.keys(nt.lineOption),((t,i)=>((0,a.uX)(),(0,a.CE)("div",j,[(0,a.Lk)("input",{type:"radio",name:"option",id:t,value:t,checked:0===i,onClick:i=>nt.nowOption=t},null,8,E),(0,a.Lk)("label",{for:t},(0,o.v_)(nt.lineOption[t]),9,D)])))),256))]),"multiLine"===nt.nowOption?((0,a.uX)(!0),(0,a.CE)(a.FK,{key:0},(0,a.pI)(Object.keys(nt.multiLineText),((t,i)=>((0,a.uX)(),(0,a.CE)("div",{key:i,class:"row"},[(0,a.Lk)("span",null,(0,o.v_)(0===i?"浮水印文字：":""),1),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":i=>nt.multiLineText[t]=i,placeholder:"輸入浮水印文字",maxlength:"100"},null,8,M),[[n.Jo,nt.multiLineText[t]]])])))),128)):((0,a.uX)(),(0,a.CE)("div",S,[U,(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":i[1]||(i[1]=t=>nt.waterprintText=t),placeholder:"輸入浮水印文字",maxlength:"100"},null,512),[[n.Jo,nt.waterprintText]])])),"fullPage"===nt.nowOption?((0,a.uX)(),(0,a.CE)("div",V,[R,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Object.keys(nt.lineHeight),((t,i)=>((0,a.uX)(),(0,a.CE)("div",X,[(0,a.Lk)("input",{type:"radio",name:"lineheight",value:t,id:t,checked:1===i,onClick:i=>nt.nowLineHeight=t},null,8,A),(0,a.Lk)("label",{for:t},(0,o.v_)(0===i?"鬆散":1===i?"一般":"密集"),9,H)])))),256))])):(0,a.Q3)("",!0),(0,a.Lk)("div",z,[I,(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":i[2]||(i[2]=t=>nt.textSize=t),step:"1",min:"10",max:"120"},null,512),[[n.Jo,nt.textSize]]),J,(0,a.bo)((0,a.Lk)("input",{type:"color","onUpdate:modelValue":i[3]||(i[3]=t=>nt.pickColor=t),onChange:i[4]||(i[4]=t=>at.getColor())},null,544),[[n.Jo,nt.pickColor]]),B,(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":i[5]||(i[5]=t=>nt.rotateDegree=t),step:"1",min:"-180",max:"180",disabled:"fullPage"===nt.nowOption},null,8,G),[[n.Jo,nt.rotateDegree]])]),(0,a.Lk)("div",K,[(0,a.Lk)("span",null,"不透明度："+(0,o.v_)(nt.opacity)+"%",1),(0,a.bo)((0,a.Lk)("input",{type:"range","onUpdate:modelValue":i[6]||(i[6]=t=>nt.opacity=t),step:"1",min:"1",max:"100"},null,512),[[n.Jo,nt.opacity]])]),(0,a.Lk)("div",Q,[$,N,(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":i[7]||(i[7]=t=>nt.xPosition=t),step:"1",min:"0",max:nt.original.xMax,disabled:"fullPage"===nt.nowOption},null,8,W),[[n.Jo,nt.xPosition]]),Y,(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":i[8]||(i[8]=t=>nt.yPosition=t),step:"1",min:"0",max:nt.original.yMax,disabled:"fullPage"===nt.nowOption},null,8,q),[[n.Jo,nt.yPosition]])])])],512),[[n.aG,!nt.getFileLoading]]),(0,a.Lk)("button",{onClick:i[9]||(i[9]=t=>at.modifyPDF()),disabled:nt.getFileLoading,class:"render_button"}," 預覽加上浮水印的文件 ",8,Z)]),(0,a.Lk)("div",tt,[(0,a.bo)((0,a.Lk)("p",null,"預覽位置",512),[[n.aG,!nt.loadingPdf]]),(0,a.bo)((0,a.Lk)("div",it,[(0,a.Lk)("iframe",et,null,512)],512),[[n.aG,nt.loadingPdf]])])])}e(4114),e(7467),e(4732),e(9577),e(6280),e(7913),e(7801),e(4603),e(7566),e(8721);const at=t=>((0,a.Qi)("data-v-4977f2f0"),t=t(),(0,a.jt)(),t),ot=at((()=>(0,a.Lk)("div",null,[(0,a.Lk)("i",{class:"bi bi-info-circle-fill"})],-1))),lt={class:"wrap_info"},st=at((()=>(0,a.Lk)("p",{class:"title"},"作者資訊",-1))),rt={class:"author"},dt=at((()=>(0,a.Lk)("p",{class:"note"},"說明：使用PDF-Lib套件，僅練習用，非商用。",-1)));function ct(t,i,e,l,s,r){return(0,a.uX)(),(0,a.CE)("button",{onClick:i[0]||(i[0]=t=>s.open=!0),class:(0,o.C4)(["wrap_author",{open:s.open}]),onBlur:i[1]||(i[1]=t=>s.open=!1)},[ot,(0,a.bo)((0,a.Lk)("div",lt,[st,(0,a.Lk)("p",rt,"開發者："+(0,o.v_)(s.author),1),dt,(0,a.Lk)("p",null,(0,o.v_)(s.repo),1)],512),[[n.aG,s.open]])],34)}var pt={data(){return{author:"Yuki Hiew",repo:"https://github.com/milkcat123/pdf_waterprint",open:!1}},methods:{}},ut=e(1241);const bt=(0,ut.A)(pt,[["render",ct],["__scopeId","data-v-4977f2f0"]]);var gt=bt,ht=e(2017),ft=e(9668);let vt,kt;var Lt={name:"App",components:{AuthorInfo:gt},data(){return{original:{name:"未上傳檔案",width:0,height:0,color:{r:1,g:0,b:0},totalPages:0,xMax:10,yMax:10},lineOption:{oneLine:"單行",fullPage:"滿版",multiLine:"多行"},nowOption:"oneLine",waterprintText:"waterprint 浮水印 waterprint 浮水印",multiLineText:{0:"000",1:"111",2:"222",3:"333"},textSize:50,xPosition:0,yPosition:0,opacity:100,rotateDegree:10,lineHeight:{loose:2,normal:1.5,tight:1},nowLineHeight:"normal",pickColor:"#ff0000",pdfBytes:null,getFileLoading:!0,loadingPdf:!1,reloading:!1}},async created(){const t="/pdf_waterprint";kt=await fetch(`${t}/font/NotoSansTC.otf`).then((t=>t.arrayBuffer()))},computed:{getTextGroup:function(){if("multiLine"===this.nowOption){let t=Object.values(this.multiLineText).filter((t=>""!==t));return[...t]}if("fullPage"===this.nowOption){let t=this.lineHeight[this.nowLineHeight]*this.textSize,i=Math.ceil(this.original.height/t);console.log("lh",i);let e=[];for(let n=0;n<i;n++)e.push(this.waterprintText);return e}return[this.waterprintText]}},methods:{async getFile(t){vt=t.target.files[0],this.original.name=vt.name;const i=await this.getReaderFile(),e=await ht.PDFDocument.load(i),n=e.getPages(),a=n[0],{width:o,height:l}=a.getSize();this.original.width=o,this.original.height=l,this.original.totalPages=n.length,this.original.xMax=Math.ceil(o),this.original.yMax=Math.ceil(l),console.log(this.original),this.getFileLoading=!1},getColor(){const t=this.pickColor;this.original.color={r:this.transferToRgb(t,1),g:this.transferToRgb(t,3),b:this.transferToRgb(t,5)},console.log("get color",this.original.color)},transferToRgb(t,i){return parseInt(t.substr(i,2),16)/255},getReaderFile(){const t=new FileReader;return new Promise(((i,e)=>{t.onload=()=>{i(t.result)},t.readAsArrayBuffer(vt)}))},async modifyPDF(){this.reloading=!0;const t=await this.getReaderFile(),i=await ht.PDFDocument.load(t);i.registerFontkit(ft.A);const e=await i.embedFont(kt),n=i.getPages();let a=this.getTextGroup;console.log("textGroup",a);const{r:o,g:l,b:s}=this.original.color,r=this.xPosition,d="fullPage"===this.nowOption?this.original.height:this.yPosition,c=this.textSize,p="fullPage"===this.nowOption?this.lineHeight[this.nowLineHeight]:1.2,u="fullPage"===this.nowOption?0:this.rotateDegree,b="fullPage"===this.nowOption?-c:a.length*c/2;n.forEach((t=>{a.forEach(((i,n)=>{const a={x:r,y:d-c*p*n+b,size:c,font:e,color:(0,ht.rgb)(o,l,s),opacity:this.opacity/100,rotate:(0,ht.degrees)(u)};t.drawText(i,a)}))})),this.pdfBytes=await i.save();const g=new Uint8Array(this.pdfBytes),h=new Blob([g],{type:"application/pdf"}),f=URL.createObjectURL(h);this.$refs.pdfView.src=f,this.loadingPdf=!0,this.reloading=!1}},watch:{}};const wt=(0,ut.A)(Lt,[["render",nt],["__scopeId","data-v-b5393b8c"]]);var mt=wt,yt=e(3699),xt=e.n(yt);const Pt=(0,n.Ef)(mt);Pt.component("Loading",xt()),Pt.mount("#app")}},i={};function e(n){var a=i[n];if(void 0!==a)return a.exports;var o=i[n]={exports:{}};return t[n].call(o.exports,o,o.exports,e),o.exports}e.m=t,function(){var t=[];e.O=function(i,n,a,o){if(!n){var l=1/0;for(c=0;c<t.length;c++){n=t[c][0],a=t[c][1],o=t[c][2];for(var s=!0,r=0;r<n.length;r++)(!1&o||l>=o)&&Object.keys(e.O).every((function(t){return e.O[t](n[r])}))?n.splice(r--,1):(s=!1,o<l&&(l=o));if(s){t.splice(c--,1);var d=a();void 0!==d&&(i=d)}}return i}o=o||0;for(var c=t.length;c>0&&t[c-1][2]>o;c--)t[c]=t[c-1];t[c]=[n,a,o]}}(),function(){e.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(i,{a:i}),i}}(),function(){e.d=function(t,i){for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)}}(),function(){e.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={57:0};e.O.j=function(i){return 0===t[i]};var i=function(i,n){var a,o,l=n[0],s=n[1],r=n[2],d=0;if(l.some((function(i){return 0!==t[i]}))){for(a in s)e.o(s,a)&&(e.m[a]=s[a]);if(r)var c=r(e)}for(i&&i(n);d<l.length;d++)o=l[d],e.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return e.O(c)},n=self["webpackChunkpdf_waterprint"]=self["webpackChunkpdf_waterprint"]||[];n.forEach(i.bind(null,0)),n.push=i.bind(null,n.push.bind(n))}();var n=e.O(void 0,[504],(function(){return e(1735)}));n=e.O(n)})();
//# sourceMappingURL=index.72614e62.js.map